---
title: "Final_Dry_Tortugas_Master_2025"
author: "Maddy Enda"
format: html
editor: visual
---

# Temperature Data 2026 Update: Dry Tortugas National Park Master File Creation

### Author- Madison Enda, January 28th, 2026

### Contact- madison.enda\@myfwc.com

## Overview:

-   In this script, we create the final dry_tortugas_master_2025.csv file, with cleaned and updated information from 2006-2025. The data was all pulled from the FWRI Coral Research Program's sharepoint drive, and was joined and standardized in the other scripts in this repository. Therefore, we will be joining the 2022, 2023, 2024, and 2025 master files to the dry_tortugas_master_2025.csv, checking for temperature anomalies, and then exporting to this device, and then the organization's drive until such a time as we have permissions to upload it to a server.

## Load libraries

```{r}
# Install librarian for multiple packages and quick readability
# install.packages("librarian")

# Using librarian::shelf to import many libraries at once
librarian::shelf(tidyverse, dplyr, here, purrr, hms, stringr)
```

- First, let's load in the large master file for all years: dry_tortugas_master_2025.csv

```{r}
# Import the master file from this working directory
dry_tortugas_master_2025 <- read_csv("dry_tortugas_master_2025.csv")
```
## Join the 2022 data to the master file

```{r}
# Import the 2022 file
dt_temp_2022 <- read_csv("C:/Users/Madison.enda/Desktop/Temp_Data/temp_dry_tortugas_2026_update/DRTO_2022_Master.csv")

# Use bind_rows to join the data
dry_tortugas_master_2025 <- bind_rows(dry_tortugas_master_2025, dt_temp_2022)
```

## Check for structural integrity

```{r}
# Find the sum of all NA values in each column
colSums(is.na(dry_tortugas_master_2025))

# Look at column names
colnames(dry_tortugas_master_2025)
```
- It seems like this extra column "...1" appeared from somewhere. I am going to remove it, as it seems the old vestige of an ID column

```{r}
# Remove the ...1 column
dry_tortugas_master_2025 <- dry_tortugas_master_2025 %>%
  select(-`...1`)
```


## Combine the 2024 and 2025 data

```{r}
# Import the 2024 file
dt_temp_2024 <- read_csv("C:/Users/Madison.enda/Desktop/Temp_Data/temp_dry_tortugas_2026_update/DRTO_2024_Master.csv")

# Import the 2025 file
dt_temp_2025 <- read_csv("C:/Users/Madison.enda/Desktop/Temp_Data/temp_dry_tortugas_2026_update/DRTO_2025_Master.csv")

# Combine the 2024 and 2025 data sets
dt_temp_2024_2025 <- bind_rows(dt_temp_2024, dt_temp_2025)
```


## Check for structural integrity and NAs

```{r}
# Find the sum of all NA values in each column
colSums(is.na(dt_temp_2024_2025))

# Remove the added id column
dt_temp_2024_2025 <- dt_temp_2024_2025 %>%
  select(-`...1`)
```

## Add a site_id column and populate with NAs to fill later with a case_when()
```{r}
# Create a site_id column that is just NAs
dt_temp_2024_2025 <- dt_temp_2024_2025 %>%
  mutate(site_id = NA)
```


## Bring together the 2024-2025 data and the master list

- It's finally time to bring it all together! We will bind the master list to the 2024 and 2025 data, then fill the missing values in site_id (should be 207,545) with the corresponding values using site_name. Then we recreate the observation_id column, run through our final checks, and it's done!

```{r}
# Use bind_rows to join the data
dry_tortugas_master_2025 <- bind_rows(dry_tortugas_master_2025, dt_temp_2024_2025)
```

- Now, let's take a look at our structure and types

```{r}
# Find the sum of all NA values in each column
colSums(is.na(dry_tortugas_master_2025))

# Look at column names
colnames(dry_tortugas_master_2025)

# Identify data types
str(dry_tortugas_master_2025)
```
## Fill the NA values in site ID

- First, we will identify all relevant site names, and correct any misspellings

```{r}
unique(dry_tortugas_master_2025$site_name)
```

```{r}
# Replace misspellings
dry_tortugas_master_2025$site_name <- str_replace_all(dry_tortugas_master_2025$site_name, c(
  "Mayers Peak" = "Mayer's Peak",
  "Black Coral Rcok" = "Black Coral Rock",
  "Pamlata Patch" = "Palmata Patch",
  "White Shaol" = "White Shoal",
  "Temptation Rock Rock" = "Temptation Rock",
  "Prolifera Patch Patch" = "Prolifera Patch"
))
```

- Now that we have all 11 sites, we need to fill the empty NA in site_id with the corresponding value for each site_name

```{r}
# Group by site_name and fill with site_id value
dry_tortugas_master_2025 <- dry_tortugas_master_2025 %>%
  group_by(site_name) %>%
  mutate(site_id = coalesce(site_id, first(site_id[!is.na(site_id)]))) %>%
  ungroup()
```

- Now let's check for any remaining NA values in any column

```{r}
# Find the sum of all NA values in each column
colSums(is.na(dry_tortugas_master_2025))

# Look at column names
colnames(dry_tortugas_master_2025)

# Identify data types
str(dry_tortugas_master_2025)
```

## Reassign character types and create new observtion_id

```{r}
# Set the site_id column as an integer
dry_tortugas_master_2025$site_id <- as.integer(dry_tortugas_master_2025$site_id)

# Set the observation_id column as an integer
dry_tortugas_master_2025$observation_id <- as.integer(dry_tortugas_master_2025$observation_id)

# Recount the observation_id column
dry_tortugas_master_2025 <- dry_tortugas_master_2025 %>%
  arrange(date) %>% # oldest â†’ newest
  mutate(observation_id = row_number()) %>% # oldest value gets id of 1
  select(observation_id, everything()) # moves observation_id to be the first column
```

## Final Checks for the 2025 Dry Tortugas Temperature Data

```{r}

```




