---
title: "Dry_Tortugas_Temp_2019-2021"
author: "Maddy Enda"
format: html
editor: visual
---

# Temperature Data 2026 Update: Dry Tortugas National Park

### Author- Madison Enda, January 26th, 2026

### Contact- madison.enda\@myfwc.com

## Overview:

-   In this script we will be cleaning and joining the temperature data csv files from Dry Tortugas National Park from 2019, 2020, and 2021. This data was pulled from the FWRI Coral Research Program's shared temperature data drive, and are master files compiled from the individual site csv files for those years.They will be cleaned, joined, and then added to the 'dry_tortugas_master_2025.csv'. The final master file will be added to the new 2026 database. For ease of access (and to avoid syncing with SharePoint which proved to take some time),the folder was downloaded manually to my device, and thus my file path is unique to my device.

-   This workflow will include general cleaning (standardizing naming conventions, removing superfluous data, etc.) and the final result will be uploaded to the shared drive once again, until permissions are received to migrate to a new platform.

## Import Libraries

```{r}
# Install librarian for multiple packages and quick readability
# install.packages("librarian")

# Using librarian::shelf to import many libraries at once
librarian::shelf(tidyverse, dplyr, here, purrr, hms)
```

## Load in the csv files from 2019-2021

```{r}
# Set folder path to where the csv files are on my local device
folder_path <- "C:/Users/Madison.enda/Desktop/Temp_Data/temp_dry_tortugas_2026_update"

# Read CSVs by combining the folder path and file name
temp_dt_2019 <- read_csv(file.path(folder_path, "DT_Temperature_18-19.csv"))
temp_dt_2020 <- read_csv(file.path(folder_path, "2020_DT_temperature.csv"))
temp_dt_2021 <- read_csv(file.path(folder_path, "DT_Temperature_2021.csv"))
```

# Investigate data: determine columns, incongruity, etc.

```{r}
# View the first few rows
colnames(temp_dt_2019)
colnames(temp_dt_2020)
colnames(temp_dt_2021)
```

-   It seems as though the 2020 and 2021 data started having observation_id (or some kind of id) added as a column already. Let's drop those columns so we can recalculate it later.

```{r}
# Remove the ID column from both data frames (2020 and 2021)
temp_dt_2020 <- temp_dt_2020 %>% select(-ID)
temp_dt_2021 <- temp_dt_2021 %>% select(-ID)
```

-   Now we can join all three of these data frames together and begin cleaning again

```{r}
# Bind all three together to begin cleaning using dplyr:bind_rows
combined_temp <- bind_rows(temp_dt_2019, temp_dt_2020, temp_dt_2021)
```

# Take a look at the data types and clean

```{r}
# Use str to inspect the column name, type, and format
str(combined_temp)
```

## Converting to proper date format

```{r}
# Use as.Date on the Date column to convert 
combined_temp$Date <- as.Date(combined_temp$Date, format = "%m/%d/%Y")

# Specify format of date as "yyyy-mm-dd", or 2006-09-15
format(combined_temp$Date,"%Y-%m-%d")
```

## Converting to hours, mins, secs in military time

```{r}
# Convert to integer before applying time
combined_temp$Time <- as.integer(combined_temp$Time)

# Convert the integer to a hour
combined_temp$Time <- hms::hms(hours = combined_temp$Time)
```

## Converting site_id to integer

```{r}
# Set the siteid column as an integer
combined_temp$Siteid <- as.integer(combined_temp$Siteid)
```

## Check one last time to see if type changes worked

```{r}
# Use str to inspect the column name, types, etc.
str(combined_temp)
```
## Ensure we have no missing data or other such issues

```{r}
# Find the sum of all NA values in each column
colSums(is.na(combined_temp))
```

```{r}
# Check to see if the highest and lowest temps make sense
max(combined_temp$`Temp F`)
min(combined_temp$`Temp F`)
```
- It seems as though we have no NA values across our data, which is awesome! However, we do need to trim some of this data, so I will be taking a look at values above 92 degrees this time (where are extraneous values fell last time)

```{r}
# Take the rows where the Temp F column has values higher than 101 degrees
high_temp_rows <- combined_temp %>%
  filter(`Temp F` > 92)
```

- Once again, these values are mostly from the same time period (September of 2018, all within a 24 hour period), and are likely the result of changing sensors and leaving them on while they remained on the hot deck of the boat, or enclosed in a heated or insulated location.  I will remove these values from the data as well.

```{r}
# Remove extraneous values
filtered_temp <- combined_temp %>%
  filter(`Temp F` < 92 )
```

## Assigning a primary key: observation ID

```{r}
# Create a column called Observation_ID
filtered_temp <- filtered_temp %>%
  arrange(Date) %>% # oldest â†’ newest
  mutate(Observation_ID = row_number()) # oldest value gets ID = 1
```

## Cleaning Names & Exporting

```{r}
# Rename old columns to be snake case (`Temp C` to Temp_C)
dt_2019_2021 <- filtered_temp %>%
  rename(
    observation_id = Observation_ID,
    date = Date,
    time = Time,
    site_name = Sitename,
    site_id = Siteid,
    temp_C = `Temp C`,
    temp_F = `Temp F`
  )
```

## Read in the master list csv with data from 2006-2018

```{r}
# Read in the csv saved to my current working directory (view the Dry_Tortugas_Temp_2006-2018.qmd)
dry_tortugas_master_2025 <- read_csv("dry_tortugas_master_2025.csv")
```

## Combine the master list with the 2019-2021 data

```{r}
# Combine the master list and 2019-2021 data using dplyr::bind_rows() to preserve columns
dry_tortugas_master_2025 <- bind_rows(dry_tortugas_master_2025, dt_2019_2021)
```

## Check to see if merge went smoothly: look for NAs, data types changes, etc.

```{r}
# Check data types
str(dry_tortugas_master_2025)

# Find the sum of all NA values in each column
colSums(is.na(dry_tortugas_master_2025))

# Check to see if the highest and lowest temps make sense
max(dry_tortugas_master_2025$temp_F)
min(dry_tortugas_master_2025$temp_F)
```
- Somehow the data types of site_id and observation_id changed to numeric, and need to be changed back to integer

```{r}
# Set the siteid column as an integer
dry_tortugas_master_2025$site_id <- as.integer(dry_tortugas_master_2025$site_id)

# Set the siteid column as an integer
dry_tortugas_master_2025$observation_id <- as.integer(dry_tortugas_master_2025$observation_id)
```

## Save final product as csv

```{r}
# Write the final data frame to a csv in my current working directory
write.csv(dry_tortugas_master_2025, "dry_tortugas_master_2025.csv", row.names = FALSE)
```


# Wrap Up:

- The Dry Tortugas National Park temperature dataset is now complete from 2006-2021. Our next step is to combine the individual csv files for the years 2022, 2023, 2024, and 2025; creating master lists for all the remaining years to be appended to the dry_tortugas_master_2025.csv


